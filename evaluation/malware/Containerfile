FROM docker.io/node:20.15.1-alpine3.20

ENV NODE_SHIELD_CONTAINER=1 \
	# Allow for running the malware
	DANGEROUS_RUN_MALWARE=1 \
	# Flag to enable install-time CBOM evaluation (applies to install-time malware only)
	INSTALL_TIME_CBOM=1

RUN apk update \
 && apk upgrade \
 && apk add --no-cache \
	bash jq tar

WORKDIR /home/malware

COPY ./ ./
RUN cd .cli \
 && npm clean-install

ENTRYPOINT ["/bin/sh"]
