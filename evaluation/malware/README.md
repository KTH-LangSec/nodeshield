# NodeShield Malware Evaluation

## Usage

- `test.sh` run the evaluation. See `SNAPSHOT` for the expected output.
- `test-ndg.sh` run the evaluation with Npm Dependency Guardian (ndg). See `SNAPSHOT` for the expected output.
- `test-one.sh` run the evaluation on one of the cases.
- `container.sh` start an interactive container to manually run the evaluation.
- `generate-cboms.sh` recompute the CBOM for each testcase.
  - `generate-cbom.sh` recompute the CBOM of one testcase.
  - NOTES
    - `event-stream-3.3.6`: the generated CBOM is expected to miss the `flatmap-stream@0.1.1` dependency.
- `generate-sboms.sh` regenerate the SBOM for each testcase.
  - `generate-sbom.sh` regenerate the SBOM of one testcase.
  - NOTES
    - `event-stream-3.3.6`: the generated SBOM is expected to miss the `flatmap-stream@0.1.1` dependency.
    - `prerequests-xcode-1.0.4`: the generated SBOM is expected to miss the `node-hide-console-window@2.1.0` dependency.
- `init-demo.sh` initialize a new testcase project.

## Duration

This evaluation is expected to take around 15 minutes.
The evaluation for NodeShield is expected to take around 10 minutes and for Npm Dependency Guardian 3 minute.

## Prerequisites

In order to run this evaluation you need the source code for all the malicious
packages. These are expected as tar archives in the `./.tarballs` directory.

If you are using the NodeShield container. Navigate to the directory on your
system that has all tarballs and run:

```shell
docker cp . nodeshield:/home/nodeshield/evaluation/malware/.tarballs
```

## Notes

All results except for 3 are expected to be reproducible, namely:

- `TESTING, CBOM, explicit` for `momnet@2.12.2`:
  - reason: behaves maliciously non-deterministically
  - command: `npm run test-explicit`
  - expected: "EvalError: Code generation from strings disallowed for this context"
- `TESTING, CBOM, explicit` for `momnet@2.27.0`:
  - reason: behaves maliciously non-deterministically
  - command: `npm run test-explicit`
  - expected: "EvalError: Code generation from strings disallowed for this context"
- `TESTING, CBOM, explicit` for `momnet@2.28.0`:
  - reason: behaves maliciously non-deterministically
  - command: `npm run test-explicit`
  - expected: "EvalError: Code generation from strings disallowed for this context"

## Index

| Package name                                            | Attack time | Type    |
| ------------------------------------------------------- | ----------- | ------- |
| `conventional-changelog@1.2.0`                          | import      | update  |
| `event-stream@3.3.6`                                    | import      | update  |
| `node-ipc@10.1.1`                                       | import      | update  |
| `rate-map@1.0.3`                                        | import      | update  |
| `@roku-web-core/ajax@1.100000000000003.100000000000003` | import      | package |
| `@roku-web-core/ajax@1.99999999999999.99999999999999`   | import      | package |
| `alicon@2.0.0`                                          | import      | package |
| `bb-builder@1.0.6`                                      | import      | package |
| `bitcionjslib@1.0.0`                                    | import      | package |
| `bitcionjslib@1.0.4`                                    | import      | package |
| `bitcoisnj-lib@1.0.4`                                   | import      | package |
| `bitcoisnj-lib@1.1.2`                                   | import      | package |
| `botbait@1.0.0`                                         | import      | package |
| `botbait@1.0.1`                                         | import      | package |
| `botbait@2.0.0`                                         | import      | package |
| `chalc@2.0.0`                                           | import      | package |
| `colors_express@1.4.5`                                  | import      | package |
| `colorsss@0.0.1`                                        | import      | package |
| `colorsss@0.0.2`                                        | import      | package |
| `commender@4.0.0`                                       | import      | package |
| `component-emiter@1.8.5`                                | import      | package |
| `discord-fix@0.0.2`                                     | import      | package |
| `discord-lofy@11.5.1`                                   | import      | package |
| `discord-selfbot-v14@12.0.3`                            | import      | package |
| `discord-vilao@1.0.0`                                   | import      | package |
| `discord.js-user@6.1.2`                                 | import      | package |
| `discordi.js@11.1.0`                                    | import      | package |
| `discordi.js@12.0.0`                                    | import      | package |
| `discordi.js@13.0.0`                                    | import      | package |
| `discordi.js@14.0.0`                                    | import      | package |
| `discordi.js@14.0.1`                                    | import      | package |
| `discordi.js@14.0.2`                                    | import      | package |
| `discordi.js@14.0.3`                                    | import      | package |
| `discordsystem@11.5.1`                                  | import      | package |
| `electron-native-notify@1.1.6`                          | import      | package |
| `esprime@2.0.0`                                         | import      | package |
| `flatmap-stream@0.1.1`                                  | import      | package |
| `headcache@2.0.0`                                       | import      | package |
| `http-proxy-middelware@2.9.0`                           | import      | package |
| `ikst@0.1.2`                                            | import      | package |
| `leetlog@0.1.2`                                         | import      | package |
| `leetlog@0.1.3`                                         | import      | package |
| `mendiff@2.0.1`                                         | import      | package |
| `momnet@2.12.2`                                         | import      | package |
| `momnet@2.27.0`                                         | import      | package |
| `momnet@2.28.0`                                         | import      | package |
| `momnet@2.29.1`                                         | import      | package |
| `monent@2.0.0`                                          | import      | package |
| `npmpubman@1.0.0`                                       | import      | package |
| `prerequests-xcode@1.0.4`                               | import      | package |
| `random-vouchercode-generator@1.0.0`                    | import      | package |
| `random-vouchercode-generator@1.0.1`                    | import      | package |
| `random-vouchercode-generator@1.0.2`                    | import      | package |
| `random-vouchercode-generator@1.0.3`                    | import      | package |
| `seemver@2.9.0`                                         | import      | package |
| `stautses@2.3.1`                                        | import      | package |
| `express-cookies@1.4.7`                                 | use         | package |
| `fast-requests@1.0.1`                                   | use         | package |
| `getcookies@1.12.3`                                     | use         | package |
| `jquerry@2.0.0`                                         | use         | package |
| `eslint-config-eslint@5.0.2`                            | install     | update  |
| `eslint-scope@3.7.2`                                    | install     | update  |
| `kraken-api@0.1.8`                                      | install     | update  |
| `mariadb@2.13.0`                                        | install     | update  |
| `opencv.js@1.0.1`                                       | install     | update  |
